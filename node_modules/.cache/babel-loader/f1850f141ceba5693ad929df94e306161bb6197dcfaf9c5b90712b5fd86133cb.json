{"ast":null,"code":"import'../Styles/LogIn.css';import{useNavigate,Link}from'react-router-dom';import{useForm}from'react-hook-form';import*as yup from'yup';import{yupResolver}from'@hookform/resolvers/yup';import{auth}from'../config/firbase';import{signInWithEmailAndPassword}from'firebase/auth';import{useState,useEffect}from'react';import{fetchExpenses}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const LogIn=()=>{const navigate=useNavigate();const[fireError,setFireError]=useState('');// Schema validation\nconst loginSchema=yup.object().shape({email:yup.string().email().required('Email is required'),pass:yup.string().min(6).required('Password is required')});const{handleSubmit,register,formState:{errors}}=useForm({resolver:yupResolver(loginSchema)});// Redirect if user is already authenticated\nuseEffect(()=>{const authUserString=localStorage.getItem('auth');if(authUserString){navigate('/dashboard');}},[navigate]);const submitLogin=async data=>{try{const userInfo=await signInWithEmailAndPassword(auth,data.email,data.pass);const userAuth={name:userInfo.user.displayName||'',email:userInfo.user.email||'',isAuth:true};localStorage.setItem('auth',JSON.stringify(userAuth));// Fetch expenses after login\nconst{expensesList,totalBalance}=await fetchExpenses(userAuth.email);// Store expenses and balance in localStorage or state if needed\nlocalStorage.setItem('expenses',JSON.stringify(expensesList));localStorage.setItem('totalBalance',totalBalance.toString());navigate('/dashboard');}catch(err){const error=err;setFireError(error.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(submitLogin),className:\"login-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Email\",...register('email')}),errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.email.message}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",...register('pass')}),errors.pass&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.pass.message}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Log In\"}),fireError&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:fireError})]}),/*#__PURE__*/_jsx(Link,{to:\"/signup\",className:\"signup-link\",children:\"Don't have an account?\"})]});};","map":{"version":3,"names":["useNavigate","Link","useForm","yup","yupResolver","auth","signInWithEmailAndPassword","useState","useEffect","fetchExpenses","jsx","_jsx","jsxs","_jsxs","LogIn","navigate","fireError","setFireError","loginSchema","object","shape","email","string","required","pass","min","handleSubmit","register","formState","errors","resolver","authUserString","localStorage","getItem","submitLogin","data","userInfo","userAuth","name","user","displayName","isAuth","setItem","JSON","stringify","expensesList","totalBalance","toString","err","error","message","className","children","onSubmit","type","placeholder","value","to"],"sources":["C:/Users/MSI/Desktop/mentor nation/github deploy/fresh-clone/src/Components/LogIn.tsx"],"sourcesContent":["import '../Styles/LogIn.css';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { useForm } from 'react-hook-form';\r\nimport * as yup from 'yup';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport { auth } from '../config/firbase';\r\nimport { signInWithEmailAndPassword } from 'firebase/auth';\r\nimport { useState, useEffect } from 'react';\r\nimport { fetchExpenses } from '../services/api';\r\n\r\ninterface LoginData {\r\n    email: string;\r\n    pass: string;\r\n}\r\n\r\nexport const LogIn = () => {\r\n    const navigate = useNavigate();\r\n    const [fireError, setFireError] = useState<string>('');\r\n\r\n    // Schema validation\r\n    const loginSchema = yup.object().shape({\r\n        email: yup.string().email().required('Email is required'),\r\n        pass: yup.string().min(6).required('Password is required'),\r\n    });\r\n\r\n    const { handleSubmit, register, formState: { errors } } = useForm<LoginData>({\r\n        resolver: yupResolver(loginSchema),\r\n    });\r\n\r\n    // Redirect if user is already authenticated\r\n    useEffect(() => {\r\n        const authUserString = localStorage.getItem('auth');\r\n        if (authUserString) {\r\n            navigate('/dashboard');\r\n        }\r\n    }, [navigate]);\r\n\r\n    const submitLogin = async (data: LoginData) => {\r\n        try {\r\n            const userInfo = await signInWithEmailAndPassword(auth, data.email, data.pass);\r\n            const userAuth = {\r\n                name: userInfo.user.displayName || '',\r\n                email: userInfo.user.email || '',\r\n                isAuth: true,\r\n            };\r\n            localStorage.setItem('auth', JSON.stringify(userAuth));\r\n            \r\n            // Fetch expenses after login\r\n            const { expensesList, totalBalance } = await fetchExpenses(userAuth.email);\r\n            \r\n            // Store expenses and balance in localStorage or state if needed\r\n            localStorage.setItem('expenses', JSON.stringify(expensesList));\r\n            localStorage.setItem('totalBalance', totalBalance.toString());\r\n\r\n            navigate('/dashboard');\r\n        } catch (err) {\r\n            const error = err as Error;\r\n            setFireError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"login-container\">\r\n            <form onSubmit={handleSubmit(submitLogin)} className=\"login-form\">\r\n                <input type=\"text\" placeholder=\"Email\" {...register('email')} />\r\n                {errors.email && <p className=\"error-message\">{errors.email.message}</p>}\r\n                <input type=\"password\" placeholder=\"Password\" {...register('pass')} />\r\n                {errors.pass && <p className=\"error-message\">{errors.pass.message}</p>}\r\n                <input type=\"submit\" value=\"Log In\" />\r\n                {fireError && <p className=\"error-message\">{fireError}</p>}\r\n            </form>\r\n            <Link to=\"/signup\" className=\"signup-link\">Don't have an account?</Link>\r\n        </div>\r\n    );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}